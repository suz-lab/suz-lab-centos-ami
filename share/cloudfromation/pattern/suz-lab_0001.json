{
    "AWSTemplateFormatVersion": "2010-09-09", 
    "Description": "SUZ-LAB Formation 0001", 
    "Mappings": {
        "AvailabilityZoneMap": {
            "ap-northeast-1": {
                "AzA": "ap-northeast-1a", 
                "AzB": "ap-northeast-1b", 
                "AzC": "ap-northeast-1c"
            }
        }
    }, 
    "Parameters": {
        "VpcId": {
            "Default"    : "vpc-xxxxxxxx", 
            "Description": "VPC ID", 
            "Type"       : "String"
        }
    },
    "Resources": {
	"IamBase": {
  	    "Type": "AWS::CloudFormation::Stack",
	    "Properties": {
	        "TemplateURL": { "Fn::Join": [ "", [
                    "http://",
                    { "Ref" : "AWS::Region" },
                    ".cloudformation.suz-lab.com.s3-",
                    { "Ref" : "AWS::Region" },
                    ".amazonaws.com/cloudformation/component/suz-lab_iam-base/0.0.2.json"
                ] ] },
	        "Parameters": {
		    "PolicyNameApi": "api" 
	        }
   	    }
        },
        "OpFwBase": {
            "Type": "AWS::CloudFormation::Stack",
            "Properties": {
                "TemplateURL": { "Fn::Join": [ "", [
                    "http://", 
                    { "Ref" : "AWS::Region" },
                    ".cloudformation.suz-lab.com.s3-",
                    { "Ref" : "AWS::Region" },
                    ".amazonaws.com/cloudformation/component/suz-lab_op-fw-base/0.0.2.json"
                ] ] },
                "Parameters" : {
                    "VpcId": { "Ref": "VpcId" }
                }
            }
        }
    },
    "Outputs": {
        "IamInstanceProfileApi": {
            "Description": "IAM Instance Profile API",
            "Value"      : { "Fn::GetAtt": [ "IamBase", "Outputs.IamInstanceProfileApi" ] }
        }, 
        "SecurityGroupIdOpNat": {
            "Description": "Security Group ID NAT",
            "Value"      : { "Fn::GetAtt": [ "OpFwBase", "Outputs.SecurityGroupIdOpNat" ] }
        }, 
        "SecurityGroupIdOdMaintenance": {
            "Description": "Security Group ID Maintenance",
            "Value"      : { "Fn::GetAtt": [ "OpFwBase", "Outputs.SecurityGroupIdOdMaintenance" ] }
        }, 
        "SecurityGroupIdOpEc2": {
            "Description": "Security Group ID EC2",
            "Value"      : { "Fn::GetAtt": [ "OpFwBase", "Outputs.SecurityGroupIdOpEc2" ] }
        } 
    } 
}

